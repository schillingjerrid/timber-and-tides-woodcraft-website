---
import BaseLayout from "../layouts/BaseLayout.astro";
import ProjectCard from "../components/ProjectCard.astro";
import { getCollection } from "astro:content";

const projects = await getCollection("projects");
const featured = projects
  .filter((p) => p.data.featured)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 6);
---

<BaseLayout
  title="Timber and Tides Woodcraft"
  description="Handcrafted woodworking projects, client feedback, and commission requests."
>
  <section class="relative overflow-hidden bg-surface py-10">
    <div
      class="absolute inset-0 opacity-30 pointer-events-none"
      style="background: radial-gradient(800px circle at 20% 10%, var(--color-deep), transparent 60%),
                          radial-gradient(700px circle at 80% 30%, var(--color-primary), transparent 55%);"
    ></div>

    <div class="relative mx-auto max-w-6xl px-4">
      <h1 class="text-3xl sm:text-4xl font-bold tracking-tight">
        Handcrafted woodworking, built to last.
      </h1>
      <p class="mt-3 max-w-2xl text-muted">
        I build custom pieces and thoughtful gifts ~ tables, shelves, cabinets, and more.
        Browse recent work, read client feedback, and reach out to request a commission.
      </p>

      <div class="mt-6 flex flex-wrap gap-3">
        <a
          href="/projects/"
          class="group inline-flex items-center justify-center rounded-xl border border-secondary/60 bg-surface px-4 py-2 text-sm font-semibold text-fg
                transition will-change-transform
                hover:bg-surface-2 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-black/30
                active:translate-y-0
                focus:outline-none focus-visible:ring-2 focus-visible:ring-secondary/70 focus-visible:ring-offset-2 focus-visible:ring-offset-bg"
        >
          View Projects
          <span class="ml-2 opacity-70 transition group-hover:opacity-100 group-hover:translate-x-0.5">→</span>
        </a>

        <a
          href="/contact/"
          class="group inline-flex items-center justify-center rounded-xl bg-primary px-4 py-2 text-sm font-semibold text-bg
                transition will-change-transform
                hover:-translate-y-0.5 hover:shadow-lg hover:shadow-black/30 hover:brightness-110
                active:translate-y-0
                focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/70 focus-visible:ring-offset-2 focus-visible:ring-offset-bg"
        >
          Request a Commission
          <span class="ml-2 opacity-80 transition group-hover:rotate-6 group-hover:scale-110">✦</span>
        </a>
      </div>
    </div>
  </section>

  <section class="mt-8">
    <div class="mx-auto max-w-6xl px-4">
      <div class="flex items-end justify-between gap-4">
        <h2 class="text-xl font-semibold">Featured Projects</h2>
        <a class="text-primary hover:text-fg transition" href="/projects/">See all →</a>
      </div>

      {featured.length === 0 ? (
        <p class="mt-4 text-zinc-300">
          Add a project in <code class="text-zinc-200">src/content/projects</code> to get started.
        </p>
      ) : (
        <div class="mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
          {featured.map((p) => (
            <ProjectCard
              href={`/projects/${p.slug}/`}
              title={p.data.title}
              excerpt={p.data.excerpt}
              coverImage={p.data.coverImage}
              tags={p.data.tags}
            />
          ))}
        </div>
      )}
    </div>
  </section>

  <section class="mt-10 bg-zinc-900/40">
    <div class="mx-auto max-w-6xl px-4 py-6">
      <h2 class="text-lg font-semibold">Plans Coming Soon</h2>
      <p class="mt-2 text-sm text-zinc-300 max-w-2xl">
        I’m working on publishing a small library of plans and cut lists. Check back later — or email me if there’s a plan you’d love to see.
      </p>
      <a
        href="/contact/"
        class="mt-4 inline-flex rounded-xl border border-zinc-700 bg-zinc-900 px-4 py-2 text-sm font-semibold text-zinc-100 hover:bg-zinc-800 transition"
      >
        Suggest a plan idea
      </a>
    </div>
  </section>

</BaseLayout>
