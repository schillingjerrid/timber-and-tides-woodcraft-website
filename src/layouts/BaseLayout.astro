---
import "../styles/theme.css";

const {
  title = "Timber and Tides Woodcraft",
  description = "Handcrafted woodworking projects and commissions.",
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    <title>{title}</title>

    <meta name="theme-color" content="#0b0f0e" />

    <!-- <link rel="icon" href="/favicon.ico" /> -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <!-- <link rel="apple-touch-icon" href="/apple-touch-icon.png" /> -->
  </head>

  <body class="min-h-screen bg-bg text-fg">
    <header class="py-6">
      <div
        class="relative mx-auto flex max-w-6xl flex-col items-center gap-4 px-4 text-center sm:flex-row sm:items-center sm:justify-between sm:text-left"
      >
        <a
          href="/"
          class="font-semibold tracking-tight text-base leading-tight text-fg sm:text-lg"
        >
          Timber and Tides Woodcraft
        </a>

        <button
          class="inline-flex items-center gap-2 text-sm text-muted transition hover:text-fg sm:hidden"
          type="button"
          aria-expanded="false"
          aria-controls="site-nav"
          data-nav-toggle
        >
          <span class="sr-only">Toggle navigation</span>
          <svg
            aria-hidden="true"
            class="h-5 w-5"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>

        <nav
          id="site-nav"
          class="absolute left-0 right-0 top-full z-20 mt-4 flex w-full flex-col items-center gap-3 overflow-hidden rounded-2xl border border-zinc-800 bg-zinc-900/95 px-6 py-4 text-sm text-muted shadow-lg backdrop-blur transition-[max-height,opacity,transform] duration-300 ease-out max-h-0 opacity-0 -translate-y-2 pointer-events-none sm:static sm:mt-0 sm:flex sm:w-auto sm:flex-row sm:gap-4 sm:border-0 sm:bg-transparent sm:p-0 sm:shadow-none sm:backdrop-blur-none sm:max-h-none sm:opacity-100 sm:translate-y-0 sm:pointer-events-auto sm:overflow-visible"
        >
          <a class="hover:text-fg transition" href="/projects/">Projects</a>
          <a class="hover:text-fg transition" href="/testimonials/">Feedback</a>
          <a class="hover:text-fg transition" href="/contact/">Contact</a>
        </nav>
      </div>
    </header>

    <main class="pb-16">
      <slot />
    </main>

    <footer class="border-t border-zinc-800 py-8 text-sm text-zinc-400">
      <div class="mx-auto flex max-w-6xl flex-col gap-2 px-4 sm:flex-row sm:items-center sm:justify-between">
        <p>&copy; {new Date().getFullYear()} Timber and Tides Woodcraft</p>
        <p class="text-zinc-500">Colorado â€¢ Commissions welcome</p>
      </div>
    </footer>

    <script>
      const toggleButton = document.querySelector("[data-nav-toggle]");
      const nav = document.querySelector("#site-nav");

      if (toggleButton && nav) {
        const openClasses = ["max-h-96", "opacity-100", "translate-y-0", "pointer-events-auto"];
        const closedClasses = ["max-h-0", "opacity-0", "-translate-y-2", "pointer-events-none"];
        let isOpen = false;

        const setNavState = (nextOpen: boolean) => {
          isOpen = nextOpen;
          toggleButton.setAttribute("aria-expanded", String(isOpen));
          openClasses.forEach((cls) => nav.classList.toggle(cls, isOpen));
          closedClasses.forEach((cls) => nav.classList.toggle(cls, !isOpen));
        };

        const toggleNav = () => setNavState(!isOpen);

        toggleButton.addEventListener("click", (event) => {
          event.stopPropagation();
          toggleNav();
        });

        document.addEventListener("click", (event) => {
          if (!isOpen) return;
          const target = event.target;
          if (target instanceof Node && (nav.contains(target) || toggleButton.contains(target))) return;
          setNavState(false);
        });

        window.addEventListener("keydown", (event) => {
          if (event.key === "Escape") {
            setNavState(false);
          }
        });
      }
    </script>
  </body>
</html>
